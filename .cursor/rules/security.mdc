---
description: Security guidelines and safety rails
globs: "**/*"
---
# Security

## Secrets & Config
- **No Secrets in Code**: Never commit `.env` files, API keys, or tokens.
- **Environment Variables**: Assume `.env` is for local development only. Production secrets must be injected via the platform.

## Authorization
- **Resolver Safety**: Every GraphQL resolver must explicitly check `context.rider` (or equivalent auth state) unless the field is intentionally public (e.g., `login`, `signup`).
- **Data Ownership**: Ensure a rider can only access *their* data (e.g., `where: { riderId: context.rider.id }`).

## Input Handling
- **Sanitization**: Do not blindly trust user input. Treat all strings as potentially malicious.
- **Rich Text**: Avoid rendering HTML from strings (`dangerouslySetInnerHTML`) unless absolutely necessary and sanitized.
