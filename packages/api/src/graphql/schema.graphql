scalar DateTime

directive @public on FIELD_DEFINITION

enum RiderRole {
    RIDER
    TRAINER
}

type Barn {
    id: ID!
    name: String!
    inviteCode: String
    riders: [Rider!]!
    createdAt: DateTime!
}

type Rider {
    id: ID!
    name: String!
    email: String!
    role: RiderRole!
    createdAt: DateTime!
    sessions: [Session!]!
    barn: Barn!
}

enum WorkType {
    FLATWORK
    JUMPING
    GROUNDWORK
    IN_HAND
    TRAIL
    OTHER
}

enum Intensity {
    LIGHT
    MODERATE
    HARD
    VERY_HARD
}

type WeeklyActivity {
    weekStart: DateTime!
    count: Int!
}

type HorseSummary {
    content: String!
    generatedAt: DateTime!
    stale: Boolean!
    refreshAvailableAt: DateTime
}

type Horse {
    id: ID!
    name: String!
    notes: String
    isActive: Boolean!
    createdAt: DateTime!
    updatedAt: DateTime!
    sessions: [Session!]!
    summary: HorseSummary
    activity(weeks: Int): [WeeklyActivity!]!
    barn: Barn!
}

type Session {
    id: ID!
    horse: Horse!
    rider: Rider!
    date: DateTime!
    durationMinutes: Int!
    workType: WorkType!
    intensity: Intensity
    rating: Int
    notes: String!
    createdAt: DateTime!
    updatedAt: DateTime!
}

type AuthPayload {
    token: String!
}

type Query {
    me: Rider!
    barn: Barn!
    horses: [Horse!]!
    riders: [Rider!]!
    sessions(
        limit: Int
        offset: Int
        horseId: ID
        riderId: ID
        workType: WorkType
        dateFrom: DateTime
        dateTo: DateTime
    ): [Session!]!
    horse(id: ID!): Horse
    session(id: ID!): Session
    lastSessionForHorse(horseId: ID!): Session
}

type Mutation {
    createHorse(name: String!, notes: String): Horse!
    updateHorse(id: ID!, name: String, notes: String, isActive: Boolean): Horse!
    createSession(
        horseId: ID!
        riderId: ID
        date: DateTime!
        durationMinutes: Int!
        workType: WorkType!
        intensity: Intensity
        rating: Int
        notes: String!
    ): Session!
    updateSession(
        id: ID!
        horseId: ID
        riderId: ID
        date: DateTime
        durationMinutes: Int
        workType: WorkType
        intensity: Intensity
        rating: Int
        notes: String
    ): Session!
    deleteSession(id: ID!): Boolean!
    updateBarn(name: String!): Barn!
    regenerateInviteCode: Barn!
    login(email: String!, password: String!): AuthPayload! @public
    signup(name: String!, email: String!, password: String!, inviteCode: String!): AuthPayload!
        @public
}
